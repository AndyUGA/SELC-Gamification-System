<div class="container mt-5">
  <div class="row">
    <div class="col">
      <table class="table">
        <thead class="leaderboard-thead">
          <tr>

            <th scope="col">Name</th>
            <th scope="col">Spots left</th>
            <th scope="col"> </th>
          </tr>
        </thead>
        <tbody>

          <% if(registeredWorkshopNumber == 3)  { %>
      
            <div class="card align-items-center mb-3"   >
              <img src="./Images/Workshops/confirmation.svg" class="card-img-top maxIconSize mt-3" alt="...">
              <div class="card-body">
                <h5 class="card-title">
                  You have successfully registered for 3 workshops!
                </h5>
              
               
              </div>
            </div>
          <% } %>

          <% for(var i = 0; i < dataArray.length; i++) { %>
          <% if(dataArray[i].show != false) { %>
          <tr>
            <td>
              <%= dataArray[i].name %>
            </td>
            <td>
              <%= dataArray[i].max - dataArray[i].attendees.length %> / <%= dataArray[i].max %>
            </td>
            <td>
              <form id="workshopRegister">
                <% if(registeredWorkshopNumber != 3)  { %>
                <button type="submit" class="btn btn-UVSASE-darkBlue">
                  <div class="text-white">
                    Register
                  </div>
                </button>
                <% } else { %>
                <button type="button" class="btn btn-secondary btn-lg" disabled>Register</button>
                <% } %>
                <input id="Workshop<%=(i+1)%>" type="hidden" value="<%= dataArray[i].name %>" />

              </form>
            </td>
          </tr>
          <%  } %>
          <% } %>


        </tbody>
      </table>
    </div>
  </div>
</div>


<script src="https://www.gstatic.com/firebasejs/7.22.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.22.1/firebase-auth.js"></script>
<script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCic5UWC0fXladccjESHt2eEUFR3GCpu7k",
    authDomain: "test-73b01.firebaseapp.com",
    databaseURL: "https://test-73b01.firebaseio.com",
    projectId: "test-73b01",
    storageBucket: "test-73b01.appspot.com",
    messagingSenderId: "622256382010",
    appId: "1:622256382010:web:305e70e752a5a757c2d503"
  };

  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();
  let userEmail = "";
  auth.onAuthStateChanged(function (user) {
    if (user) {

      userEmail = user.email;
      $("#currentUserEmail").val(userEmail);
    } else {
      console.log(58, "user not signed in");
    }
  });

  document
    .addEventListener("submit", (event) => {
      event.preventDefault();


      console.log(88, event.target[1].id);


      return fetch("/registerWorkshop", {
        method: "POST",
        headers: {
          Accept: "application/json",
          "Content-Type": "application/json",
          "CSRF-Token": Cookies.get("XSRF-TOKEN"),
        },
        body: JSON.stringify({
          userEmail,
          selectedWorkshop: event.target[1].id,
          workshopName: event.target[1].value,
        }),
      })
        .then(() => {
          location.reload();
        });

    });



</script>